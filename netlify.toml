[build]
  # CRITICAL FIX: We chain the install command before the build command.
  # This forces Netlify to install 'vite' (a devDependency) even in production mode.
  command = "npm install --include=dev && npm run build"

  # Publish the unified dist folder (containing demos + lib)
  publish = "dist"

  # Function directory
  functions = "tests/functions"

[dev]
  command = "npm run dev"
  targetPort = 5173
  publish = "tests/public"